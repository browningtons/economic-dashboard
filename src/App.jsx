import React, { useState, useEffect, useMemo } from 'react';
import { 
  LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend, 
  ReferenceArea, ComposedChart, ScatterChart, Scatter, AreaChart, Area
} from 'recharts';
import { 
  Activity, CheckSquare, Square, TrendingUp, 
  BarChart2, Minus, AlertTriangle, Sun, Moon,
  Target, Info, HelpCircle
} from 'lucide-react';

// --- FULL INITIAL DATASET (UPDATED with Stock Market Value & National Debt) ---
const INITIAL_CSV_DATA = `observation_date,unemployment_rate,avg_weeks_unemployed,median_weeks_unemployed,job_openings,unemployed_27_weeks,unemployed_count,fed_rate,15 year mortgage,30 year mortgage,S&P 500,Labor Participation Rate,Labor Participation Core,Housing Price Index,CPI,GDP,Stock Market (b),National Debt (b)
1/1/00,4,13.1,5.8,,721,,5.45,7.803,8.210,1425.6,67.3,84.4,100.0,181.1,10002,13230.62,5777.2
2/1/00,4.1,12.6,6.1,,629,,5.73,7.933,8.325,1388.9,67.3,84.4,100.6,181.5,10086,13511.00,5835.2
3/1/00,4,12.7,6,,646,,5.85,7.832,8.240,1442.2,67.3,84.3,101.5,182.0,10164,14296.18,5926.6
4/1/00,3.8,12.4,6.1,,599,,6.02,7.800,8.153,1461.4,67.3,84.4,102.5,182.3,10248,13516.50,5961.3
5/1/00,4,12.6,5.8,,643,,6.27,8.183,8.515,1418.5,67.1,84.1,103.7,182.7,10319,13431.60,5966.5
6/1/00,4,12.3,5.7,,627,,6.53,7.992,8.288,1462,67.1,84.1,104.9,183.2,10403,13538.00,5952.9
7/1/00,4,13.4,6,,698,,6.54,7.865,8.148,1473,66.9,83.9,105.7,183.9,10477,13469.80,5918.1
8/1/00,4.1,12.9,6.3,,709,,6.50,7.763,8.028,1485.5,66.9,83.8,106.5,184.6,10555,13890.40,5934.8
9/1/00,3.9,12.2,5.2,,646,,6.52,7.604,7.912,1468.1,66.9,83.7,107.1,185.3,10629,13450.90,5924.1
10/1/00,3.9,12.7,6.1,,627,,6.51,7.470,7.795,1390.1,66.8,83.6,107.7,186.1,10729,12970.00,5887.3
11/1/00,3.9,12.4,6.1,,593,,6.51,7.418,7.745,1378,66.9,83.8,108.3,186.8,10825,11978.60,5918.6
12/1/00,3.9,12.5,6,5088,642,,6.40,7.056,7.382,1330.9,67.0,83.9,108.8,187.6,10912,11846.40,5924.1
1/1/01,4.2,12.7,5.8,5234,676,,5.98,6.640,7.033,1335.6,67.2,84.1,109.2,188.2,10967,12329.60,5990.8
2/1/01,4.2,12.8,6.1,5097,714,,5.49,6.640,7.050,1305.8,67.1,84.1,109.6,188.9,11045,11224.10,6023.7
3/1/01,4.3,12.8,6.6,4762,696,,5.31,6.508,6.952,1185.9,67.2,84.1,110.4,189.6,11124,10545.80,6046.3
4/1/01,4.4,12.4,5.9,4615,712,,4.80,6.595,7.078,1189.8,66.9,83.7,111.2,190.2,11210,11388.30,5995.3
5/1/01,4.3,12.1,6.3,4425,624,,4.21,6.675,7.145,1270.4,66.7,83.8,112.2,191.0,11306,11492.30,5977.6
6/1/01,4.5,12.7,6,4361,710,,3.97,6.700,7.160,1238.7,66.7,83.6,113.3,191.6,11384,11393.00,5952.1
7/1/01,4.6,12.9,6.8,4447,702,,3.77,6.683,7.128,1204.5,66.8,83.6,114.2,192.3,11456,11205.80,5962.6
8/1/01,4.9,13.3,6.9,4024,857,,3.65,6.500,6.950,1178.5,66.5,83.5,115.0,193.1,11533,10581.50,5983.0
9/1/01,5,13.2,7.2,4071,819,,3.07,6.340,6.818,1044.6,66.8,83.5,115.5,193.9,11612,9528.00,6010.3
10/1/01,5.3,13.3,7.3,3707,909,,2.49,6.098,6.618,1076.6,66.7,83.6,115.7,194.7,11690,9844.00,6044.1
11/1/01,5.5,14.3,7.7,3775,1106,,2.09,6.146,6.658,1129.7,66.7,83.5,115.8,195.5,11780,10522.40,6119.3
12/1/01,5.7,14.5,8.2,3677,1126,,1.82,6.543,7.065,1144.9,66.7,83.7,116.1,196.4,11874,10675.90,6140.1
1/1/02,5.7,14.7,8.4,3699,1203,,1.73,6.480,6.998,1140.2,66.5,83.5,116.4,197.0,11933,10463.40,6156.3
2/1/02,5.7,15,8.3,3436,1214,,1.74,6.375,6.893,1100.7,66.8,83.7,116.9,197.7,12005,10345.00,6197.0
3/1/02,5.7,15.4,8.4,3612,1330,,1.73,6.516,7.014,1153.8,66.6,83.5,117.9,198.2,12093,10834.10,6217.7
4/1/02,5.9,16.3,8.9,3471,1457,,1.75,6.475,6.985,1111.9,66.7,83.6,119.2,198.5,12177,10303.50,6229.3
5/1/02,5.8,16.8,9.5,3457,1574,,1.75,6.280,6.806,1079.3,66.7,83.6,120.8,198.8,12270,10200.00,6278.8
6/1/02,5.8,16.9,11,3412,1641,,1.75,6.105,6.650,1014,66.6,83.2,122.3,199.3,12371,9565.30,6346.0
7/1/02,5.8,16.9,8.9,3367,1584,,1.73,5.930,6.485,903.59,66.5,83.1,123.7,199.8,12431,8717.50,6365.8
8/1/02,5.7,16.5,9,3517,1573,,1.74,5.702,6.290,912.55,66.6,83.2,124.7,200.2,12502,8784.50,6398.0
9/1/02,5.7,17.6,9.5,3301,1580,,1.75,5.508,6.093,867.81,66.7,83.3,125.5,200.7,12586,8094.00,6416.7
10/1/02,5.7,17.8,9.6,3479,1653,,1.75,5.500,6.113,854.63,66.6,83.2,126.1,201.3,12678,8579.50,6476.1
11/1/02,5.9,17.6,9.3,3514,1743,,1.34,5.464,6.068,909.93,66.4,82.9,126.6,202.0,12771,9092.50,6524.6
12/1/02,6,18.5,9.6,3169,1924,,1.24,5.450,6.048,899.18,66.3,83.1,127.2,202.5,12852,8669.20,6552.5
1/1/03,5.8,18.5,9.6,3441,1760,,1.24,5.304,5.916,895.84,66.4,82.9,127.7,203.3,12928,8460.40,6586.6
2/1/03,5.9,18.5,9.5,3229,1864,,1.26,5.220,5.843,837.03,66.4,83.0,128.3,203.7,13012,8325.10,6624.0
3/1/03,5.9,18.1,9.7,3099,1798,,1.25,5.065,5.745,846.63,66.3,83.1,129.3,204.1,13098,8389.50,6659.5
4/1/03,6,19.4,10.2,3108,1927,,1.26,5.118,5.813,890.03,66.4,83.2,130.5,204.5,13192,9025.30,6673.7
5/1/03,6.1,19.0,9.9,3289,1929,,1.26,4.860,5.484,935.96,66.4,83.1,131.8,204.9,13280,9518.20,6767.9
6/1/03,6.3,19.9,11.5,3390,2100,,1.22,4.628,5.230,988,66.5,83.3,133.2,205.1,13385,9673.00,6802.6
7/1/03,6.2,19.7,10.3,2981,1972,,1.01,4.968,5.633,992.54,66.2,83.0,134.6,205.6,13470,9827.00,6822.1
8/1/03,6.1,19.2,10.1,3190,1995,8896,1.03,5.588,6.264,989.53,66.1,83.0,136.0,206.1,13554,10067.50,6894.8
9/1/03,6.1,19.5,10.2,3091,2014,8921,1.01,5.458,6.148,1019.4,66.1,82.8,137.1,206.6,13643,9940.50,6934.6
10/1/03,6,19.3,10.4,3305,1959,8732,1.01,5.274,5.952,1038.7,66.1,82.9,138.0,206.9,13745,10469.10,6993.0
11/1/03,5.8,19.9,10.3,3324,2006,8576,1.00,5.273,5.933,1049.9,66.1,82.8,138.8,207.5,13837,10583.90,7028.6
12/1/03,5.7,19.8,10.4,3414,1931,8317,0.98,5.204,5.876,1080.6,65.9,82.8,139.6,207.9,13928,11128.60,7088.4
1/1/04,5.7,19.9,10.6,3424,1911,8370,1.00,5.015,5.713,1132.5,66.1,82.8,140.7,208.3,14013,11375.20,7137.7
2/1/04,5.6,20.1,10.2,3532,1856,8167,1.01,4.938,5.635,1143.4,66.0,82.7,142.0,208.8,14101,11536.20,7190.8
3/1/04,5.8,19.8,10.2,3525,1983,8491,1.00,4.740,5.445,1124,66.0,82.8,144.1,209.2,14197,11369.60,7252.0
4/1/04,5.6,19.6,9.5,3511,1805,8170,1.00,5.158,5.830,1133.4,65.9,82.7,146.2,209.7,14300,11184.80,7272.3
5/1/04,5.6,19.8,9.9,3710,1799,8212,1.00,5.638,6.270,1102.8,66.0,82.8,148.3,210.2,14407,11334.60,7316.9
6/1/04,5.6,20.5,11,3337,1847,8286,1.03,5.660,6.288,1132.8,66.1,82.9,150.5,210.7,14515,11560.60,7348.7
7/1/04,5.5,18.8,8.9,3814,1681,8136,1.26,5.464,6.056,1105.9,66.1,83.0,152.3,211.2,14605,10987.30,7376.2
8/1/04,5.4,18.8,9.2,3541,1640,7990,1.43,5.260,5.868,1088.9,66.0,82.7,153.8,211.9,14705,11028.20,7425.7
9/1/04,5.4,19.4,9.6,3821,1702,7927,1.61,5.144,5.754,1117.7,65.8,82.7,155.1,212.4,14808,11182.80,7485.0
10/1/04,5.5,19.5,9.5,3943,1737,8061,1.76,5.115,5.723,1117.2,65.9,82.6,156.3,212.8,14902,11340.50,7529.2
11/1/04,5.4,19.7,9.7,3472,1702,7932,1.93,5.135,5.730,1173.8,66.0,82.7,157.5,213.2,14995,11886.50,7648.0
12/1/04,5.4,19.4,9.5,4074,1653,7934,2.16,5.178,5.752,1213.6,65.9,82.6,158.7,213.9,15091,12262.90,7701.2
1/1/05,5.3,19.5,9.4,3804,1648,7784,2.28,5.173,5.710,1181.3,65.8,82.7,160.1,214.5,15174,11893.40,7726.4
2/1/05,5.4,19.1,9.2,3965,1628,7980,2.50,5.150,5.628,1203.6,65.9,82.8,161.9,215.0,15264,12105.80,7782.3
3/1/05,5.2,19.5,9.3,4044,1660,7737,2.63,5.464,5.928,1180.6,65.9,82.6,164.6,215.5,15359,11943.20,7841.8
4/1/05,5.2,19.6,9,4159,1609,7672,2.79,5.408,5.855,1156.9,66.1,82.7,167.0,216.0,15456,11634.60,7870.5
5/1/05,5.1,18.6,9.1,3797,1538,7651,3.00,5.280,5.720,1191.5,66.1,82.9,169.5,216.4,15545,11977.70,7883.7
6/1/05,5.0,17.9,9,4062,1375,7524,3.04,5.168,5.582,1191.3,66.1,82.6,172.0,216.8,15640,12172.60,7914.4
7/1/05,5.0,17.6,8.8,4256,1380,7406,3.26,5.278,5.695,1234.2,66.1,82.8,174.1,217.5,15726,12567.90,7972.3
8/1/05,4.9,18.4,9.2,4142,1407,7345,3.50,5.400,5.820,1228.8,66.2,82.9,175.9,218.0,15822,12467.20,8019.1
9/1/05,5.0,17.9,8.4,4352,1439,7553,3.62,5.358,5.774,1228.8,66.1,82.9,177.6,218.6,15902,12588.70,8069.2
10/1/05,5.0,17.9,8.6,4184,1422,7453,3.78,5.625,6.065,1207,66.1,82.7,178.8,219.3,15989,12374.20,8138.1
11/1/05,5.0,17.5,8.5,4248,1370,7566,4.00,5.863,6.330,1249.5,66.0,82.7,179.7,220.0,16086,12734.30,8220.4
12/1/05,4.9,17.5,8.7,4282,1356,7279,4.16,5.816,6.272,1248.3,66.0,82.7,180.1,220.5,16186,12814.50,8256.8
1/1/06,4.7,16.9,8.6,4397,1170,7064,4.29,5.710,6.145,1280.1,66.0,82.8,180.8,220.9,16260,13185.50,8302.6
2/1/06,4.8,17.8,9.1,4325,1350,7184,4.49,5.860,6.253,1280.7,66.1,82.9,181.5,221.6,16347,13245.10,8373.9
3/1/06,4.7,17.1,8.7,4732,1309,7072,4.59,5.968,6.324,1294.9,66.2,83.0,182.7,222.3,16447,13428.90,8438.3
4/1/06,4.7,16.7,8.4,4790,1331,7120,4.79,6.155,6.508,1309.9,66.1,82.8,183.6,222.9,16544,13600.40,8468.2
5/1/06,4.6,17.1,8.5,4463,1333,6980,4.94,6.205,6.598,1287.2,66.1,82.8,184.4,223.6,16637,13192.00,8454.1
6/1/06,4.6,16.6,7.3,4614,1145,7001,4.99,6.306,6.682,1270.2,66.2,82.8,184.5,224.4,16738,13167.00,8506.4
7/1/06,4.7,17.1,8,4394,1304,7175,5.24,6.390,6.763,1278.6,66.1,83.0,184.6,225.2,16812,13078.10,8552.7
8/1/06,4.7,17.1,8.4,4710,1306,7091,5.25,6.198,6.524,1303.8,66.2,82.9,184.4,226.2,16909,13370.10,8601.2
9/1/06,4.5,17.1,8,4737,1245,6847,5.25,6.078,6.403,1336.3,66.1,82.9,184.2,227.1,17006,13684.80,8643.6
10/1/06,4.4,16.3,7.9,4591,1078,6727,5.25,6.050,6.358,1377.9,66.2,82.9,184.1,228.0,17105,14083.10,8681.0
11/1/06,4.5,16.2,8.3,4645,1131,6872,5.25,5.956,6.240,1400.6,66.3,83.0,183.6,228.9,17205,14359.40,8753.2
12/1/06,4.4,16.1,7.5,4620,1093,6762,5.24,5.880,6.135,1418.3,66.4,83.1,183.2,230.0,17300,14527.70,8789.6
1/1/07,4.6,16.3,8.3,4763,1141,7116,5.25,5.965,6.218,1438.2,66.4,83.4,182.7,230.8,17392,14791.30,8798.9
2/1/07,4.5,16.7,8.5,4699,1249,6927,5.26,6.020,6.285,1407.3,66.3,83.2,182.5,231.7,17482,14526.50,8871.4
3/1/07,4.4,17.8,9.1,4962,1245,6731,5.26,5.884,6.156,1420.9,66.2,83.2,182.2,232.5,17582,14697.60,8923.2
4/1/07,4.5,16.9,8.6,4689,1206,6850,5.25,5.883,6.180,1482.4,65.9,83.0,182.1,233.0,17684,15285.80,8959.9
5/1/07,4.4,16.6,8.2,4657,1132,6766,5.25,5.968,6.262,1515.9,66.0,83.0,181.9,233.5,17781,15697.90,8976.7
6/1/07,4.6,16.5,7.7,4859,1143,6979,5.25,6.340,6.658,1503.4,66.0,82.9,181.5,234.1,17873,15439.60,9000.9
7/1/07,4.7,17.2,8.7,4598,1291,7149,5.26,6.360,6.695,1474,66.0,82.9,181.0,234.7,17957,14982.20,9039.7
8/1/07,4.6,17,8.8,4546,1246,7067,5.02,6.234,6.572,1452.1,65.8,82.9,180.2,235.3,18042,15167.20,9079.3
9/1/07,4.7,16.3,8.7,4652,1264,7170,4.94,6.048,6.383,1486.6,66.0,82.8,179.1,236.1,18127,15680.20,9128.2
10/1/07,4.7,17,8.4,4636,1298,7237,4.76,6.040,6.375,1539.7,65.8,82.7,177.5,237.1,18227,16083.70,9194.7
11/1/07,4.7,17.3,8.6,4646,1374,7240,4.49,5.850,6.208,1463.4,66.0,82.9,175.2,238.2,18322,15345.20,9259.2
12/1/07,5.0,16.6,8.4,4545,1324,7645,4.24,5.753,6.095,1479.2,66.0,83.1,173.3,239.1,18413,15186.90,9333.5
1/1/08,5.0,17.5,9,4624,1388,7685,3.94,5.288,5.758,1378.8,66.2,83.3,171.1,239.9,18501,14145.30,9372.0
2/1/08,4.9,16.9,8.7,4279,1329,7497,2.98,5.440,5.918,1354.9,66.0,83.2,169.2,240.3,18585,13640.90,9468.0
3/1/08,5.1,16.5,8.7,4225,1323,7822,2.61,5.420,5.970,1316.9,66.1,83.3,167.9,240.9,18671,13367.20,9522.7
4/1/08,5.0,16.9,9.4,4035,1372,7637,2.28,5.465,5.918,1370.5,65.9,83.1,167.3,241.5,18767,13970.90,9498.4
5/1/08,5.4,16.6,7.9,4194,1561,8395,1.98,5.600,6.036,1403.2,66.1,83.1,167.0,241.8,18854,14368.00,9547.4
6/1/08,5.6,17.1,9,3830,1576,8575,2.00,5.910,6.320,1341.3,66.1,83.1,166.5,242.6,18944,13235.10,9622.4
7/1/08,5.8,17,9.7,3749,1664,8937,2.01,5.972,6.426,1257.3,66.1,83.1,165.7,243.4,19028,13116.10,9665.7
8/1/08,6.1,17.7,9.7,3674,1866,9438,2.00,6.025,6.478,1281.5,66.1,83.2,164.3,244.2,19114,13304.20,9735.2
9/1/08,6.1,18.6,10.2,3222,2027,9494,1.81,5.640,6.038,1217,66.0,83.1,161.9,244.9,19198,12249.70,10041.1
10/1/08,6.5,19.9,10.4,3377,2280,10074,0.97,5.892,6.200,968.8,66.0,83.0,159.2,245.9,19277,10143.40,10440.0
11/1/08,6.8,18.9,9.8,3231,2219,10538,0.39,5.790,6.088,883.04,65.9,83.0,156.1,246.7,19358,9312.80,10604.6
12/1/08,7.3,19.9,10.5,3146,2610,11286,0.16,5.038,5.286,877.56,65.8,82.8,152.5,247.3,19438,9426.80,10743.8
1/1/09,7.8,19.8,10.7,2738,2699,12058,0.15,4.718,5.048,865.58,65.7,82.8,149.4,248.0,19515,8743.70,10742.8
2/1/09,8.3,20.2,11.7,2864,2999,12898,0.22,4.773,5.130,805.23,65.8,82.8,147.6,248.3,19602,7875.90,10864.4
3/1/09,8.7,20.9,12.3,2534,3260,13426,0.18,4.638,5.003,757.13,65.6,82.6,146.5,248.6,19688,8456.10,11112.3
4/1/09,9.0,21.7,13.1,2295,3752,13853,0.15,4.500,4.810,848.15,65.7,82.8,146.9,248.9,19769,9284.40,11218.2
5/1/09,9.4,22.4,14.2,2549,3973,14499,0.18,4.515,4.858,902.41,65.7,82.9,148.2,249.1,19856,9760.40,11335.5
6/1/09,9.5,23.9,17.2,2503,4349,14707,0.21,4.903,5.420,926.12,65.7,82.9,149.8,249.1,19941,9782.80,11563.1
7/1/09,9.5,25.1,16,2232,4917,14601,0.16,4.692,5.222,935.82,65.5,82.8,150.7,249.0,20025,10640.80,11623.7
8/1/09,9.6,25.3,16.3,2338,5037,14814,0.16,4.613,5.193,1009.73,65.4,82.8,150.7,249.0,20108,11031.20,11823.1
9/1/09,9.8,26.6,17.8,2487,5494,15009,0.15,4.493,5.058,1044.55,65.1,82.5,149.6,249.0,20194,11443.50,11927.0
10/1/09,10.0,27.5,18.9,2406,5643,15352,0.12,4.390,4.952,1067.66,65.0,82.5,148.6,248.9,20275,11205.50,12044.8
11/1/09,9.9,28.9,19.8,2503,5908,15219,0.12,4.343,4.875,1088.07,65.0,82.4,147.9,248.9,20358,11848.40,12145.2
12/1/09,9.9,29.7,20.1,2568,6122,15098,0.12,4.392,4.930,1110.38,64.6,82.0,146.7,249.0,20442,12118.40,12343.6
1/1/10,9.8,30.3,20,2837,6319,15046,0.11,4.435,5.030,1123.58,64.8,82.4,145.0,249.1,20524,11737.70,12390.0
2/1/10,9.8,29.8,19.9,2666,6129,15113,0.13,4.368,4.990,1089.16,64.9,82.3,143.1,249.0,20614,12141.70,12562.6
3/1/10,9.9,31.6,20.4,2679,6545,15202,0.16,4.330,4.968,1152.05,64.9,82.4,143.6,249.1,20706,12862.60,12814.0
4/1/10,9.9,33.3,22.1,3153,6800,15325,0.20,4.418,5.098,1197.32,65.2,82.6,145.4,249.0,20786,13088.60,12943.9
5/1/10,9.6,34,22.3,2988,6638,14849,0.20,4.278,4.888,1125.06,64.9,82.3,147.0,248.9,20876,12015.10,13079.6
6/1/10,9.4,34.5,25.2,2801,6623,14474,0.18,4.175,4.738,1083.36,64.6,82.2,147.7,249.0,20963,11345.60,13219.7
7/1/10,9.4,33.9,22.3,3082,6506,14512,0.18,4.040,4.564,1079.8,64.6,81.9,147.6,249.1,21045,12202.30,13295.7
8/1/10,9.5,33.7,21,2999,6259,14648,0.19,3.908,4.428,1087.28,64.7,82.0,146.4,249.0,21128,11616.50,13467.4
9/1/10,9.5,33.4,20.3,2918,6163,14579,0.19,3.810,4.346,1122.08,64.6,82.0,144.6,249.4,21215,12653.70,13577.2
10/1/10,9.4,34,21.2,3235,6227,14516,0.19,3.660,4.225,1171.58,64.4,81.8,143.1,249.6,21303,13105.80,13680.6
11/1/10,9.8,33.9,21,3211,6326,15081,0.19,3.683,4.300,1198.89,64.6,82.0,141.8,250.3,21389,13105.80,13878.3
12/1/10,9.3,34.7,21.9,3058,6429,14348,0.18,4.058,4.714,1241.53,64.3,81.9,140.6,251.0,21473,13989.90,14042.9
1/1/11,9.1,37.2,21.5,3104,6175,14013,0.17,4.088,4.755,1304.49,64.2,81.7,139.0,251.6,21564,14305.80,14148.1
2/1/11,9.0,37.4,21.1,3226,5892,13820,0.16,4.215,4.953,1321.12,64.1,81.6,137.7,251.8,21650,14792.90,14204.1
3/1/11,9.0,39.1,21.5,3261,6105,13737,0.14,4.080,4.836,1304.49,64.2,81.7,137.8,252.1,21738,14825.10,14287.7
4/1/11,9.1,38.7,20.9,3259,5925,13957,0.10,4.055,4.840,1331.51,64.2,81.7,139.2,252.2,21827,15263.50,14297.7
5/1/11,9.0,39.6,21.6,3179,6153,13855,0.09,3.823,4.638,1338.31,64.1,81.7,140.7,252.4,21915,15084.60,14359.7
6/1/11,9.1,39.9,22.4,3455,6271,13962,0.09,3.694,4.510,1287.29,64.0,81.7,141.9,252.6,22005,14808.40,14357.2
7/1/11,9.0,40.7,22,3623,6195,13763,0.07,3.680,4.545,1325.19,64.0,81.4,142.3,253.1,22086,14517.40,14356.0
8/1/11,9.0,40.5,22.4,3329,6048,13818,0.10,3.460,4.270,1185.31,64.1,81.6,141.8,254.0,22177,13652.00,14696.0
9/1/11,9.0,40.4,22,3774,6304,13948,0.08,3.318,4.106,1173.88,64.2,81.5,140.2,254.6,22256,12677.60,14814.0
10/1/11,8.8,38.7,20.6,3619,5838,13594,0.07,3.348,4.068,1207.22,64.1,81.3,138.4,255.7,22345,13960.90,14898.4
11/1/11,8.6,40.2,20.8,3565,5698,13302,0.08,3.305,3.993,1226.42,64.1,81.5,136.7,256.4,22434,13940.40,15056.6
12/1/11,8.5,40.4,20.5,3768,5586,13093,0.07,3.246,3.958,1243.32,64.0,81.6,135.2,257.2,22521,14063.50,15240.0
1/1/12,8.3,40.2,20.8,3909,5476,12797,0.08,3.200,3.915,1300.58,63.7,81.5,134.2,257.7,22606,14682.10,15376.8
2/1/12,8.3,39.7,19.7,3616,5242,12813,0.10,3.163,3.890,1352.49,63.8,81.5,134.0,258.2,22687,15299.50,15507.6
3/1/12,8.2,39.3,19.2,3979,5236,12713,0.13,3.198,3.954,1389.24,63.8,81.5,135.9,258.6,22778,15771.40,15597.0
4/1/12,8.2,39.2,19.1,3793,5132,12646,0.14,3.143,3.910,1386.43,63.7,81.4,138.5,258.9,22864,15752.90,15703.4
5/1/12,8.2,39.6,19.9,3835,5401,12660,0.16,3.034,3.798,1341.27,63.7,81.4,141.0,259.2,22955,14790.30,15782.0
6/1/12,8.2,40.3,20.4,3911,5409,12692,0.16,2.953,3.675,1323.48,63.8,81.5,143.2,259.4,23049,15316.90,15861.2
7/1/12,8.2,39.3,17.5,3735,5210,12656,0.16,2.845,3.550,1359.78,63.7,81.4,144.3,260.1,23133,15494.50,15936.7
8/1/12,8.1,39.6,18.4,3809,5042,12471,0.13,2.860,3.602,1403.45,63.5,81.4,144.7,260.7,23223,15860.30,16014.7
9/1/12,7.8,39.8,18.8,3882,4911,12115,0.14,2.803,3.498,1443.42,63.6,81.5,144.3,261.4,23308,16288.40,16085.9
10/1/12,7.8,39.6,19.9,3775,4988,12124,0.16,2.693,3.383,1437.82,63.8,81.6,144.0,262.7,23397,16002.10,16199.9
11/1/12,7.7,39.0,18.6,3878,4805,12005,0.16,2.662,3.352,1394.51,63.6,81.2,143.9,263.4,23479,16162.40,16334.6
12/1/12,7.9,37.6,17.7,3970,4768,12298,0.16,2.658,3.345,1422.29,63.7,81.4,143.9,264.1,23559,16336.80,16436.9
1/1/13,8.0,35.6,15.8,3923,4681,12471,0.14,2.696,3.414,1480.4,63.7,81.1,144.3,264.7,23632,17230.40,16506.2
2/1/13,7.7,36.4,17.2,4004,4691,11950,0.15,2.768,3.533,1512.31,63.4,81.0,145.2,265.3,23712,17413.70,16578.3
3/1/13,7.5,37.0,17.6,4076,4563,11689,0.14,2.758,3.565,1550.83,63.3,81.0,148.0,265.8,23797,18132.50,16720.9
4/1/13,7.6,36.5,17.1,3988,4468,11760,0.15,2.660,3.445,1570.7,63.4,81.0,151.0,266.0,23880,18445.90,16747.5
5/1/13,7.5,36.8,17.1,4145,4347,11654,0.11,2.722,3.536,1639.84,63.4,81.2,153.9,266.6,23963,18954.60,16722.5
6/1/13,7.5,36.4,17,4150,4355,11751,0.09,3.168,4.070,1618.77,63.4,81.2,156.4,266.9,24047,18696.60,16711.7
7/1/13,7.3,37.3,16.2,3885,4258,11335,0.09,3.430,4.370,1668.68,63.3,81.2,158.3,267.5,24131,19774.90,16715.9
8/1/13,7.2,37.6,16.5,4085,4296,11279,0.08,3.488,4.456,1670.09,63.3,81.0,159.4,268.5,24217,19290.00,16701.9
9/1/13,7.2,37.4,16.5,4128,4132,11270,0.08,3.523,4.490,1687.17,63.2,81.0,159.7,269.1,24302,19872.90,16698.2
10/1/13,7.2,35.1,16.3,4222,4024,11136,0.09,3.274,4.192,1720.03,62.8,80.6,159.5,270.0,24391,20758.80,17120.9
11/1/13,6.9,36.6,17.1,4119,4042,10787,0.08,3.298,4.255,1783.54,63.0,81.0,159.4,270.7,24482,21338.60,17189.0
12/1/13,6.7,36.5,17.3,4121,3863,10404,0.09,3.483,4.458,1807.78,62.9,80.8,159.3,271.7,24576,21917.20,17322.2
1/1/14,6.6,35.1,15.4,4127,3607,10202,0.07,3.480,4.432,1822.36,62.9,80.9,159.4,272.3,24667,21122.40,17323.1
2/1/14,6.7,36.5,15.9,4373,3783,10349,0.07,3.350,4.303,1817.04,62.9,81.1,159.9,272.7,24751,22125.30,17433.2
3/1/14,6.7,35.3,15.8,4388,3704,10380,0.08,3.360,4.343,1863.52,63.1,81.1,161.2,273.5,24842,22236.20,17578.0
4/1/14,6.2,34.9,15.7,4566,3479,9702,0.09,3.393,4.338,1864.26,62.8,80.8,163.0,274.1,24939,22329.00,17560.7
5/1/14,6.3,34.4,14.6,4747,3360,9859,0.09,3.290,4.192,1889.77,62.9,80.7,164.7,274.7,25032,22831.10,17533.9
6/1/14,6.1,33.9,13.8,4982,3116,9460,0.10,3.265,4.163,1947.09,62.8,81.0,166.2,275.3,25134,23324.90,17610.9
7/1/14,6.2,32.7,13.1,4846,3136,9608,0.09,3.236,4.130,1973.1,62.9,80.8,167.1,276.2,25227,22865.60,17660.8
8/1/14,6.1,32,12.9,5349,2958,9599,0.09,3.248,4.115,1961.53,62.9,81.1,167.4,277.0,25321,23867.10,17727.5
9/1/14,5.9,31.9,13.4,4914,2948,9262,0.09,3.308,4.163,1993.23,62.8,80.8,167.2,278.0,25419,23259.70,17781.3
10/1/14,5.7,32.3,13.6,5012,2892,8990,0.09,3.210,4.036,1937.27,62.9,80.9,166.9,279.0,25515,23804.00,17926.1
11/1/14,5.8,32.7,13,4843,2828,9090,0.09,3.188,3.998,2044.57,62.9,80.9,166.6,280.1,25608,24434.80,18007.3
12/1/14,5.6,32.7,12.9,5130,2799,8717,0.12,3.128,3.864,2054.27,62.8,80.9,166.4,280.9,25697,24343.60,18116.2
1/1/15,5.7,32,13.2,5344,2774,8885,0.11,2.985,3.670,2028.18,62.9,81.0,166.2,281.6,25791,23535.80,18086.3
2/1/15,5.5,31.2,12.9,5466,2658,8599,0.11,3.008,3.710,2082.2,62.7,80.9,166.6,282.4,25879,24920.20,18153.0
3/1/15,5.4,30.5,12,5210,2542,8515,0.11,3.040,3.770,2079.99,62.6,80.8,168.1,283.1,25974,24571.80,18145.5
4/1/15,5.4,30.9,11.5,5598,2560,8550,0.12,2.942,3.672,2094.86,62.8,81.0,169.9,283.6,26071,24798.70,18157.8
5/1/15,5.6,30.7,11.6,5563,2503,8834,0.12,3.063,3.840,2111.94,62.9,81.1,171.8,284.2,26164,25066.40,18150.7
6/1/15,5.3,28.4,11.8,5248,2162,8247,0.13,3.193,3.983,2099.29,62.7,80.9,173.4,285.0,26268,24631.90,18131.6
7/1/15,5.2,28.1,10.9,6056,2127,8167,0.13,3.214,4.046,2094.14,62.6,80.7,174.5,286.1,26359,25152.10,18138.0
8/1/15,5.1,28.4,11.7,5467,2172,7992,0.14,3.128,3.905,2039.87,62.6,80.7,174.9,287.1,26456,23598.60,18139.4
9/1/15,5.0,25.7,11.3,5488,2097,7907,0.14,3.095,3.890,1944.41,62.4,80.6,175.0,288.3,26553,22857.80,18136.7
10/1/15,5.0,27.5,11.3,5773,2130,7922,0.12,3.010,3.796,2024.81,62.5,80.8,175.0,289.4,26645,24700.90,18133.3
11/1/15,5.1,27.9,11,5708,2074,8000,0.12,3.163,3.943,2080.62,62.5,80.9,175.1,290.3,26740,24794.90,18882.8
12/1/15,5.0,27.9,11,5845,2127,7907,0.24,3.206,3.964,2054.08,62.7,80.9,175.1,291.2,26829,24333.60,18906.6
1/1/16,4.8,29.1,11.3,6012,2081,7627,0.34,3.155,3.873,1918.6,62.7,81.1,175.0,292.0,26920,22981.40,18995.6
2/1/16,4.9,29.4,11.3,5770,2150,7702,0.38,2.960,3.660,1904.42,62.8,81.1,175.3,292.8,27011,23067.60,19064.7
3/1/16,5.0,28.3,11.3,6129,2231,7961,0.36,2.966,3.694,2021.95,63.0,81.3,176.6,293.5,27101,24625.30,19225.7
4/1/16,5.1,27.9,11.1,5803,2147,8067,0.37,2.870,3.605,2075.54,62.9,81.2,178.5,294.2,27189,24766.60,19179.6
5/1/16,4.8,26.9,10.7,5777,1925,7652,0.37,2.843,3.600,2065.55,62.7,81.2,180.3,295.0,27282,25132.90,19254.4
6/1/16,4.9,28.0,10.8,5742,1986,7744,0.38,2.842,3.568,2083.89,62.7,81.3,181.9,295.9,27376,25076.60,19359.0
7/1/16,4.8,27.8,11.1,5962,1943,7641,0.39,2.748,3.440,2148.9,62.8,81.3,183.0,296.9,27464,25986.70,19395.7
8/1/16,4.9,27.2,10.7,5677,1970,7784,0.40,2.745,3.435,2170.95,62.9,81.4,183.6,297.9,27555,26064.90,19512.8
9/1/16,5.0,26.5,10.2,5868,1933,7953,0.40,2.756,3.460,2157.69,62.9,81.5,183.9,299.0,27650,26039.10,19545.7
10/1/16,4.9,26.6,10.1,5591,1946,7811,0.40,2.763,3.470,2143.02,62.8,81.5,184.0,300.4,27743,25571.10,19784.1
11/1/16,4.7,25.9,10.3,5971,1865,7553,0.41,3.028,3.770,2164.99,62.7,81.4,184.2,301.6,27833,26652.00,19914.1
12/1/16,4.7,26.3,10.6,5964,1860,7521,0.54,3.428,4.198,2246.63,62.7,81.3,184.4,302.7,27928,27159.20,19948.1
1/1/17,4.7,25.3,10.3,5617,1866,7468,0.65,3.388,4.150,2275.12,62.8,81.5,184.6,303.5,28022,27733.10,19944.3
2/1/17,4.6,25.5,10.1,5923,1803,7379,0.66,3.380,4.168,2329.91,62.9,81.6,185.0,304.2,28114,28800.90,19855.0
3/1/17,4.4,25.1,10.3,5811,1677,7073,0.79,3.414,4.196,2366.82,62.9,81.6,186.5,304.9,28205,28823.20,19809.7
4/1/17,4.4,24.1,9.9,6091,1709,7089,0.90,3.300,4.045,2359.31,63.0,81.7,188.5,305.5,28300,29134.30,19831.7
5/1/17,4.4,24.7,10.5,5826,1721,7000,0.91,3.255,4.010,2395.35,62.8,81.7,190.5,306.4,28392,29469.60,19836.9
6/1/17,4.3,24.6,10,6305,1654,6873,1.04,3.174,3.904,2433.99,62.8,81.6,192.2,307.3,28489,29531.40,19828.5
7/1/17,4.3,24.6,10.2,6238,1720,6892,1.15,3.235,3.968,2454.1,62.9,81.8,193.5,308.2,28585,29944.10,19806.8
8/1/17,4.4,24,10.3,6276,1687,7082,1.16,3.160,3.880,2456.22,62.9,81.6,194.3,309.5,28678,30043.50,19804.8
9/1/17,4.3,26.1,10.1,6320,1683,6854,1.15,3.105,3.805,2492.84,63.1,81.9,194.8,310.3,28771,30614.80,20204.2
10/1/17,4.2,26.2,9.7,6408,1609,6700,1.15,3.200,3.895,2557,62.7,81.6,195.1,311.5,28864,31318.00,20426.9
11/1/17,4.2,25.7,9.8,6271,1589,6774,1.16,3.288,3.922,2593.61,62.7,81.7,195.4,312.7,28957,32002.60,20548.2
12/1/17,4.1,24.2,9.3,6336,1516,6632,1.30,3.385,3.950,2664.34,62.7,81.8,195.8,313.9,29050,32354.40,20483.6
1/1/18,4.0,24.2,9.7,6621,1467,6489,1.41,3.483,4.033,2789.8,62.7,81.7,196.1,314.8,29141,34020.00,20487.2
2/1/18,4.1,22.9,9.2,6552,1432,6581,1.42,3.785,4.330,2705.16,63.0,82.1,196.9,315.3,29235,32794.80,20819.0
3/1/18,4.0,24.0,8.8,6818,1345,6472,1.51,3.910,4.444,2702.77,62.9,82.0,198.5,315.9,29328,32017.50,21067.7
4/1/18,4.0,22.5,9.6,6877,1375,6459,1.69,3.925,4.468,2653.63,62.9,82.0,200.6,316.8,29419,32223.50,21049.0
5/1/18,3.8,21.1,9.2,7016,1233,6196,1.70,4.066,4.586,2701.49,62.9,81.9,202.4,317.5,29511,32995.80,21098.5
6/1/18,4.0,20.8,9,7230,1404,6447,1.82,4.040,4.570,2754.35,63.0,82.1,204.0,318.3,29606,33048.20,21135.5
7/1/18,3.8,23.1,9.8,7190,1416,6195,1.91,4.008,4.528,2793.64,63.0,82.1,204.9,319.4,29701,33944.90,21267.3
8/1/18,3.8,22.4,9.3,7208,1287,6156,1.91,4.018,4.550,2857.82,62.6,81.9,205.3,320.7,29787,34965.50,21385.1
9/1/18,3.7,24.2,9.2,7411,1351,6073,1.95,4.080,4.628,2901.5,62.8,81.9,205.3,321.5,29875,34812.40,21496.0
10/1/18,3.8,23.1,9.4,7304,1348,6211,2.19,4.248,4.830,2785.46,62.9,82.3,205.3,322.6,29972,32251.10,21690.5
11/1/18,3.8,22.1,8.9,7594,1228,6115,2.20,4.282,4.866,2723.23,62.9,82.2,205.1,324.0,30064,32787.10,21824.3
12/1/18,3.9,21.9,9.6,7489,1306,6389,2.27,4.090,4.638,2567.31,63.0,82.3,204.7,324.8,30165,29719.50,21951.3
1/1/19,4.0,20.5,9.5,7502,1287,6475,2.40,3.906,4.464,2607.39,63.1,82.5,204.2,325.6,30252,32241.80,21929.3
2/1/19,3.8,21.8,9.6,7066,1283,6136,2.40,3.800,4.370,2754.86,63.1,82.5,204.4,326.4,30335,33432.40,22044.6
3/1/19,3.8,22.2,9.6,7317,1264,6202,2.41,3.718,4.265,2803.98,63.0,82.4,205.7,327.5,30425,33767.70,21938.5
4/1/19,3.7,22.5,9.2,7272,1230,5961,2.42,3.605,4.143,2903.8,62.8,82.2,207.7,328.7,30514,34962.90,21927.3
5/1/19,3.6,24.0,9.2,7275,1299,5930,2.39,3.534,4.072,2854.71,62.9,82.2,209.3,329.3,30603,32840.00,21935.3
6/1/19,3.6,21.6,9.6,7194,1333,5935,2.38,3.238,3.803,2890.17,63.0,82.2,210.6,330.6,30694,35006.00,21983.7
7/1/19,3.7,19.6,8.9,7042,1227,6061,2.40,3.203,3.765,2996.11,63.1,82.1,211.3,331.6,30784,35310.20,22007.0
8/1/19,3.6,21.9,8.7,7178,1257,5945,2.13,3.082,3.616,2897.5,63.1,82.5,211.7,332.6,30876,34477.30,22489.6
9/1/19,3.5,22.5,9.2,7124,1338,5753,2.04,3.115,3.605,2982.16,63.2,82.7,211.8,333.8,30965,35044.40,22599.7
10/1/19,3.6,22.4,9,7289,1291,5871,1.83,3.142,3.688,2977.68,63.3,82.8,211.9,334.7,31057,35749.30,22935.4
11/1/19,3.6,20.3,8.9,6888,1208,5868,1.55,3.158,3.695,3104.9,63.3,82.9,212.1,335.8,31154,36935.50,23064.5
12/1/19,3.6,20.7,9.1,6699,1188,5853,1.55,3.178,3.720,3176.75,63.3,83.0,212.2,336.8,31247,37733.90,23096.0
1/1/20,3.6,21.9,10,7124,1176,5869,1.55,3.072,3.624,3278.2,63.3,83.1,212.4,337.8,31336,37753.60,23168.0
2/1/20,3.5,20.6,9.4,6966,1110,5753,1.58,2.970,3.465,3277.31,63.3,82.9,213.2,338.6,31427,34657.90,23358.8
3/1/20,4.4,17.0,6,5894,1140,7206,0.65,2.885,3.450,2652.39,62.6,82.4,215.2,339.5,31518,29963.30,23522.1
4/1/20,14.8,7.2,2.2,4606,910,23084,0.05,2.804,3.306,2761.98,60.1,79.8,217.2,340.1,31604,33564.10,24862.6
5/1/20,13.2,10.5,7.7,5612,1147,20929,0.05,2.693,3.233,2919.61,60.8,80.6,218.5,340.8,31690,35566.90,25685.1
6/1/20,11.0,14.4,13.4,6129,1355,17652,0.08,2.603,3.163,3104.66,61.5,81.4,219.8,341.3,31779,36579.70,26370.1
7/1/20,10.2,17.0,14.7,6530,1544,16352,0.09,2.520,3.016,3207.62,61.5,81.2,221.5,342.0,31868,38585.10,26483.8
8/1/20,8.4,19.9,16.2,6429,1632,13461,0.10,2.475,2.935,3391.71,61.7,81.3,224.0,342.4,31958,40970.50,26677.1
9/1/20,7.8,21.5,17.5,6511,2445,12554,0.09,2.385,2.890,3365.52,61.4,80.9,226.8,342.9,32049,39578.80,26883.1
10/1/20,6.9,22.0,19,6798,3591,11072,0.09,2.346,2.834,3418.7,61.7,81.3,229.8,343.6,32145,38637.10,27188.9
11/1/20,6.7,23.3,18.3,6820,3924,10694,0.09,2.305,2.765,3548.99,61.5,81.0,232.3,344.0,32235,43023.90,27344.5
12/1/20,6.7,23.2,16.8,6773,3967,10770,0.09,2.218,2.684,3695.31,61.5,81.1,234.3,344.5,32326,44669.70,27645.8
1/1/21,6.4,25.9,16.1,7204,4032,10236,0.09,2.200,2.735,3793.75,61.4,81.1,236.4,344.8,32414,44901.00,27713.3
2/1/21,6.2,27.5,18.4,7752,4143,9995,0.08,2.238,2.810,3883.43,61.4,81.1,239.2,345.2,32504,46322.20,27807.7
3/1/21,6.1,29.6,20.3,8470,4171,9756,0.07,2.393,3.083,3910.51,61.5,81.3,244.2,345.7,32598,47774.80,27951.1
4/1/21,6.1,28.4,20.3,9356,4082,9762,0.07,2.364,3.060,4141.18,61.6,81.3,249.8,346.3,32692,50304.70,27972.3
5/1/21,5.8,29.6,19.5,9905,3707,9266,0.06,2.280,2.963,4167.85,61.6,81.3,255.4,347.0,32782,50565.60,28138.9
6/1/21,5.9,32.0,19.8,10298,3988,9462,0.08,2.270,2.975,4238.49,61.7,81.6,261.1,347.8,32872,51766.20,28408.5
7/1/21,5.4,29.8,14.7,11049,3477,8731,0.10,2.180,2.868,4363.71,61.8,81.8,265.5,348.5,32960,52525.70,28398.1
8/1/21,5.1,29.5,14.2,10956,3189,8276,0.09,2.145,2.843,4454.21,61.7,81.7,268.7,349.7,33056,54015.90,28399.4
9/1/21,4.7,28.5,13.2,10879,2714,7652,0.08,2.184,2.900,4445.54,61.7,81.6,271.4,351.3,33149,51530.80,28392.0
10/1/21,4.5,26.8,12.4,11341,2371,7279,0.08,2.308,3.068,4460.71,61.8,81.8,273.6,352.9,33246,55116.50,28415.6
11/1/21,4.2,28.9,12.3,11119,2181,6751,0.08,2.358,3.068,4667.39,61.9,82.0,276.0,354.5,33340,53904.30,28804.3
12/1/21,3.9,28.0,11.5,11417,1993,6398,0.08,2.348,3.098,4674.77,62.0,82.0,278.5,355.9,33434,53448.70,29493.5
1/1/22,4.0,24.5,10,11238,1656,6512,0.08,2.660,3.445,4573.82,62.2,82.1,281.9,357.7,33527,49804.00,29876.7
2/1/22,3.8,26.3,10.1,11661,1689,6301,0.08,2.998,3.763,4435.98,62.2,82.2,287.1,359.6,33621,48546.20,30204.2
3/1/22,3.7,24.2,8.8,12134,1380,6014,0.20,3.390,4.172,4391.27,62.3,82.5,294.9,361.1,33719,49665.50,30312.9
4/1/22,3.7,24.8,8.6,11881,1386,6002,0.33,4.215,4.983,4391.3,62.2,82.4,301.5,363.0,33814,44923.80,30310.5
5/1/22,3.6,22.4,9,11483,1294,5983,0.77,4.435,5.230,4040.36,62.3,82.6,306.3,365.1,33912,44477.00,30384.7
6/1/22,3.6,22.3,8,11256,1355,5951,1.21,4.652,5.522,3898.95,62.2,82.3,308.1,367.9,34010,40500.90,30445.6
7/1/22,3.5,22.2,8.3,11610,1120,5768,1.68,4.613,5.413,3911.73,62.1,82.3,306.9,370.4,34110,44258.80,30558.6
8/1/22,3.6,22.4,8.6,10148,1231,5919,2.33,4.563,5.223,4158.56,62.3,82.8,303.5,373.3,34204,42319.00,30721.1
9/1/22,3.5,20.2,8.1,10812,1118,5792,2.56,5.350,6.112,3850.52,62.3,82.6,300.3,376.6,34301,38708.00,30756.9
10/1/22,3.6,20.8,8,10488,1214,5964,3.08,6.145,6.900,3726.05,62.2,82.6,298.6,379.4,34401,41724.30,31086.6
11/1/22,3.6,21.5,8.2,10619,1244,5943,3.78,6.138,6.805,3917.49,62.1,82.4,296.8,382.6,34503,43337.30,31227.1
12/1/22,3.5,19.4,8.2,10876,1073,5766,4.10,5.668,6.364,3912.38,62.3,82.6,294.2,385.6,34604,40565.80,31323.0
1/1/23,3.5,20.3,9.7,10393,1087,5747,4.33,5.425,6.273,3960.66,62.4,82.8,292.7,388.4,34693,43375.30,31408.4
2/1/23,3.6,19.3,8.9,9846,1056,5962,4.57,5.415,6.258,4079.68,62.5,83.0,293.5,391.1,34789,42246.00,31438.7
3/1/23,3.5,19.5,8.4,9572,1061,5839,4.65,5.796,6.544,3968.56,62.6,83.1,297.5,392.9,34882,43425.20,31453.1
4/1/23,3.4,20.9,8.8,9992,1079,5751,4.83,5.663,6.343,4121.47,62.6,83.3,301.6,394.9,34978,43880.80,31449.9
5/1/23,3.6,21.2,9,9310,1142,6089,5.06,5.808,6.425,4146.17,62.6,83.4,305.4,396.7,35071,44194.20,31455.0
6/1/23,3.6,20.7,8.7,9191,1121,5958,5.08,6.088,6.714,4345.37,62.6,83.4,308.4,398.6,35165,46886.90,32253.1
7/1/23,3.5,20.6,9,8606,1196,5920,5.12,6.178,6.840,4508.08,62.6,83.4,310.3,400.2,35255,48443.30,32510.5
8/1/23,3.7,20.4,8.8,9287,1369,6284,5.33,6.430,7.072,4426.24,62.8,83.5,311.7,402.2,35351,47634.10,32821.0
9/1/23,3.8,21.4,9,9279,1242,6326,5.33,6.573,7.200,4409.1,62.7,83.5,312.5,404.5,35445,45614.00,33060.0
10/1/23,3.9,21.5,8.5,8550,1331,6479,5.33,6.905,7.620,4258.98,62.7,83.4,312.9,406.7,35542,44593.20,33551.6
11/1/23,3.7,19.4,8.8,8663,1170,6254,5.33,6.766,7.442,4460.06,62.8,83.4,312.1,408.8,35641,48647.30,33719.0
12/1/23,3.8,22.2,9.6,8585,1273,6315,5.33,6.138,6.815,4685.05,62.5,83.2,310.9,410.6,35735,50886.30,33879.2
1/1/24,3.7,20.8,9.6,8468,1272,6149,5.33,5.870,6.643,4804.49,62.5,83.3,310.8,412.0,35824,51425.70,34056.3
2/1/24,3.9,20.9,9.3,8445,1213,6462,5.33,6.102,6.776,5011.96,62.6,83.5,312.7,413.7,35921,53815.40,34306.4
3/1/24,3.9,21.6,9.5,8093,1254,6497,5.33,6.175,6.820,5170.57,62.7,83.4,316.9,415.2,36014,55373.20,34494.7
4/1/24,3.9,20.0,8.9,7619,1253,6492,5.33,6.263,6.993,5095.5,62.7,83.5,320.9,416.4,29147,53130.80,34554.4
5/1/24,4.0,21.2,9,7901,1348,6635,5.33,6.346,7.060,5235.2,62.6,83.6,323.8,417.8,29267,55278.80,34537.7
6/1/24,4.1,20.7,9.8,7412,1533,6849,5.33,6.188,6.918,5415.1,62.6,83.7,325.3,418.8,29391,56924.70,34712.4
7/1/24,4.2,20.6,9.5,7504,1543,7097,5.33,6.135,6.848,5542.9,62.7,83.9,325.7,420.6,29512,57586.10,35007.4
8/1/24,4.2,21.0,9.5,7649,1545,7071,5.33,5.682,6.500,5502.2,62.7,83.9,325.1,422.2,29617,56554.44,33437.6
9/1/24,4.1,22.6,9.9,7103,1614,6901,5.13,5.263,6.180,5626.1,62.7,83.8,324.7,423.8,29723,57636.94,33882.5
10/1/24,4.1,22.9,10.1,7615,1608,6972,4.83,5.598,6.428,5792.3,62.5,83.5,324.1,425.4,29825,57178.68,33749.5
11/1/24,4.2,23.6,10.5,8031,1654,7121,4.64,6.028,6.805,5929.9,62.5,83.5,323.8,426.7,29898,60880.74,34025.8`;

// --- THEME & PALETTE ---
const COLORS = {
  purple: "#8884d8",
  green: "#10b981", // Emerald 500
  orange: "#f59e0b", // Amber 500
  red: "#ef4444",    // Red 500
  brick: "#b91c1c",  // Red 700
  brown: "#78350f",  // Amber 900
  pink: "#ec4899",   // Pink 500
  lightGreen: "#86efac",
  blue: "#3b82f6",   // Blue 500
  darkBg: "#1f2937", // Gray 800
  lightBg: "#ffffff",
  gridLight: "#e5e7eb",
  gridDark: "#374151",
  teal: "#14b8a6",
  yellow: "#facc15"
};

// --- INDICATOR CONFIG ---
const INDICATOR_CONFIG = {
  "S&P 500": { label: "S&P 500", definition: "Market cap index of 500 leading US companies.", color: COLORS.green, unit: "", dataKey: "S&P 500", decimals: 2 },
  job_openings: { label: "Job Openings (k)", definition: "Unfilled jobs on last business day of month (in thousands).", color: COLORS.orange, unit: "", dataKey: "job_openings", format: 'count', decimals: 0 },
  unemployment_rate: { label: "Unemployment Rate", definition: "Unemployed as % of labor force.", color: COLORS.purple, unit: "%", dataKey: "unemployment_rate", format: 'percent', decimals: 2 },
  avg_weeks_unemployed: { label: "Avg Weeks Unemployed", definition: "Average duration of unemployment.", color: COLORS.lightGreen, unit: " wks", dataKey: "avg_weeks_unemployed", decimals: 1 },
  fed_rate: { label: "Fed Rate", definition: "Overnight federal funds interest rate.", color: COLORS.red, unit: "%", dataKey: "fed_rate", format: 'percent', decimals: 2 },
  CPI: { label: "CPI (Inflation)", definition: "Consumer Price Index (inflation measure).", color: COLORS.pink, unit: "", dataKey: "CPI", decimals: 2 },
  "30 year mortgage": { label: "30Y Mortgage", definition: "Fixed rate for 30-year mortgages.", color: COLORS.brick, unit: "%", dataKey: "30 year mortgage", format: 'percent', decimals: 2 },
  "Housing Price Index": { label: "Housing Index", definition: "Single-family house price movement.", color: COLORS.brown, unit: "", dataKey: "Housing Price Index", decimals: 2 },
  
  // New indicators
  median_weeks_unemployed: { label: "Median Weeks Unemployed", definition: "Median duration of unemployment.", color: COLORS.teal, unit: " wks", dataKey: "median_weeks_unemployed", decimals: 1 },
  unemployed_27_weeks: { label: "Long-Term Unemployed (k)", definition: "Number of people unemployed for 27 weeks or more (in thousands).", color: COLORS.yellow, unit: "", dataKey: "unemployed_27_weeks", format: 'count', decimals: 0 },
  "Labor Participation Rate": { label: "Labor Participation Rate", definition: "Percentage of the working-age population that is employed or actively looking for a job.", color: COLORS.blue, unit: "%", dataKey: "Labor Participation Rate", format: 'percent', decimals: 2 },
  // Helper keys
  GDP: { label: "GDP (Billions)", definition: "Gross Domestic Product.", color: COLORS.blue, unit: "", dataKey: "GDP", decimals: 0, format: 'count' },
  "Stock Market (b)": { label: "Total Stock Market (Billions)", definition: "Wilshire 5000 Total Market Full Cap Index.", color: COLORS.blue, unit: "", dataKey: "Stock Market (b)", decimals: 0, format: 'count' },
};

// --- REFERENCE ZONES ---
const REFERENCE_ZONES = [
  { label: "Dot Com", start: "2001-03-01", end: "2001-11-01", color: "#9ca3af", opacity: 0.3, labelPos: 'insideTopLeft' },
  { label: "Great Recession", start: "2007-12-01", end: "2009-06-01", color: "#9ca3af", opacity: 0.3, labelPos: 'insideTopLeft' },
  { label: "COVID-19", start: "2020-02-01", end: "2020-04-01", color: "#9ca3af", opacity: 0.3, labelPos: 'insideTop' },
  { label: "ChatGPT Launch", start: "2022-11-01", end: "2023-01-01", color: "#9ca3af", opacity: 0.3, labelPos: 'insideBottom' },
];

// --- UTILS ---
const normalizeDate = (dateStr) => {
  const parts = dateStr.split('/');
  if (parts.length === 3) {
    const [month, day, year] = parts;
    const fullYear = (year.length === 2 ? (parseInt(year) < 50 ? '20' : '19') + year : year);
    return `${fullYear}-${month.padStart(2, '0')}-${day.padStart(2, '0')}`;
  }
  const d = new Date(dateStr);
  if (isNaN(d.getTime())) return dateStr;
  return d.toISOString().split('T')[0];
};

// UPDATED: Simple parser for CSV without quoted commas
const parseCSV = (csvText) => {
  const lines = csvText.trim().split('\n');
  const headers = lines[0].split(',').map(h => h.trim());
  return lines.slice(1).map(line => {
    if (!line.trim()) return null;
    const values = line.split(',').map(val => val.trim());
    
    const entry = {};
    headers.forEach((header, index) => {
      let value = values[index];
      if (header === 'observation_date') {
        entry[header] = normalizeDate(value);
      } else {
        // Handle empty strings (blanks) as null, parse everything else to a number
        const num = parseFloat(value);
        entry[header] = (value === "" || isNaN(num)) ? null : num;
      }
    });
    return entry;
  }).filter(item => item !== null);
};

// --- FORMATTER ---
const dataFormatter = (value, dataKey) => {
    if (value === null || value === undefined) return 'N/A';
    const configKey = Object.keys(INDICATOR_CONFIG).find(key => INDICATOR_CONFIG[key].dataKey === dataKey) || dataKey;
    const config = INDICATOR_CONFIG[configKey];
    
    let formattedValue = value;
    if (config) {
        if (config.format === 'percent') {
            formattedValue = value.toFixed(config.decimals) + '%';
        } else if (config.format === 'count' && typeof value === 'number') {
            // Remove 'k' suffix, format as integer with comma separator
            formattedValue = Math.round(value).toLocaleString();
        } else if (config.unit) {
             formattedValue = value.toFixed(config.decimals) + config.unit;
        } else if (typeof value === 'number') {
             formattedValue = value.toFixed(config.decimals ?? 2);
        }
    } else if (typeof value === 'number') {
         formattedValue = value.toFixed(2);
    }
    return formattedValue;
};


const calculatePearsonRSquared = (data, key1, key2) => {
  const pairs = data.map(d => ({ x: d[key1], y: d[key2] })).filter(p => p.x != null && p.y != null);
  const n = pairs.length;
  if (n < 2) return null;
  let sumX = 0, sumY = 0, sumXY = 0, sumX2 = 0, sumY2 = 0;
  pairs.forEach(p => {
    sumX += p.x;
    sumY += p.y;
    sumXY += p.x * p.y;
    sumX2 += p.x * p.x;
    sumY2 += p.y * p.y;
  });
  const numerator = (n * sumXY) - (sumX * sumY);
  const denominatorX = (n * sumX2) - (sumX * sumX);
  const denominatorY = (n * sumY2) - (sumY * sumY);
  if (denominatorX === 0 || denominatorY === 0) return null;
  const r = numerator / Math.sqrt(denominatorX * denominatorY);
  return r * r;
};

// --- CALCULATIONS ---
const calculateSahmRule = (data) => {
  return data.map((row, index) => {
    if (index < 14) return null; 
    const current = row['unemployment_rate'];
    const prev1 = data[index - 1]?.['unemployment_rate'];
    const prev2 = data[index - 2]?.['unemployment_rate'];
    if (current == null || prev1 == null || prev2 == null) return null;
    const threeMonthAvg = (current + prev1 + prev2) / 3;
    let lowestAvg = threeMonthAvg;
    for (let i = 1; i <= 12; i++) {
        const pRow = data[index - i];
        const pRow1 = data[index - i - 1];
        const pRow2 = data[index - i - 2];
        if (!pRow || !pRow1 || !pRow2) continue;
        const pCurrent = pRow['unemployment_rate'];
        const pPrev1 = pRow1['unemployment_rate'];
        const pPrev2 = pRow2['unemployment_rate'];
        if (pCurrent != null && pPrev1 != null && pPrev2 != null) {
            const avg = (pCurrent + pPrev1 + pPrev2) / 3;
            if (avg < lowestAvg) lowestAvg = avg;
        }
    }
    const sahmValue = threeMonthAvg - lowestAvg;
    return {
      date: row['observation_date'],
      sahmValue,
      threshold: 0.50,
      isRecession: sahmValue >= 0.50
    };
  }).filter(item => item !== null);
};

const calculatePhilipsData = (data) => {
  return data.map((row, index) => {
    if (index < 12) return null;
    const prevCPI = data[index - 12]?.['CPI'];
    const currCPI = row['CPI'];
    if (prevCPI == null || currCPI == null) return null;
    return {
      x: row['unemployment_rate'],
      y: ((currCPI - prevCPI) / prevCPI) * 100,
      date: row['observation_date']
    };
  }).filter(item => item && item.x != null && item.y != null);
};

// UPDATED: Calculate True Buffett Indicator (Total Market / GDP)
const calculateBuffettIndicator = (data) => {
    let lastKnownGDP = null;

    return data.map(row => {
        let gdp = row['GDP'];
        const marketCap = row['Stock Market (b)']; 
        
        // LOCF for GDP to handle quarterly vs monthly mismatches
        if (gdp != null) {
            lastKnownGDP = gdp;
        } else {
            gdp = lastKnownGDP; 
        }

        if (gdp == null || marketCap == null) return null;
        
        // Ratio = (Total Market Value / GDP) * 100 to get percentage
        return {
            date: row['observation_date'],
            ratio: (marketCap / gdp) * 100 
        };
    }).filter(d => d);
};

// --- Custom Label (Not used on Buffett chart as requested) ---
const CustomLabel = (props) => {
  const { x, y, stroke, value, index, dataLength } = props;
  if (index === dataLength - 1 && value !== null && value !== undefined) {
    return (
      <text x={x} y={y} dy={-10} dx={-10} fill={stroke} fontSize={12} textAnchor="end" fontWeight="bold">
        {value.toFixed(0)}%
      </text>
    );
  }
  return null;
};

// --- COMPONENT ---
export default function App() {
  const [data, setData] = useState([]);
  const [selectedKeys, setSelectedKeys] = useState(new Set(["S&P 500", "job_openings"])); 
  const [viewMode, setViewMode] = useState("dashboard"); 
  const [chartMode, setChartMode] = useState("absolute");
  const [showSpread, setShowSpread] = useState(false);
  const [darkMode, setDarkMode] = useState(false);

  useEffect(() => {
    setData(parseCSV(INITIAL_CSV_DATA));
  }, []);

  useEffect(() => {
    if (darkMode) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
  }, [darkMode]);

  const toggleIndicator = (key) => {
    const newSet = new Set(selectedKeys);
    if (newSet.has(key)) { 
        if (newSet.size > 1) newSet.delete(key); 
    } else { 
        newSet.add(key); 
    }
    setSelectedKeys(newSet);
  };

  const sahmData = useMemo(() => calculateSahmRule(data), [data]);
  const philipsData = useMemo(() => calculatePhilipsData(data), [data]);
  const buffettData = useMemo(() => calculateBuffettIndicator(data), [data]);

  const processedData = useMemo(() => {
    if (chartMode === "absolute") return data;
    const baselines = {};
    Array.from(selectedKeys).forEach(key => {
      const dKey = INDICATOR_CONFIG[key].dataKey;
      const firstValid = data.find(d => d[dKey] != null);
      if (firstValid) baselines[key] = firstValid[dKey];
    });

    return data.map(row => {
      const newRow = { ...row };
      Array.from(selectedKeys).forEach(key => {
        const dKey = INDICATOR_CONFIG[key].dataKey;
        if (row[dKey] != null && baselines[key]) {
          newRow[dKey] = (row[dKey] / baselines[key]) * 100;
        }
      });
      if (chartMode === "indexed" && selectedKeys.size === 2) {
        const keys = Array.from(selectedKeys);
        const val1 = newRow[INDICATOR_CONFIG[keys[0]].dataKey];
        const val2 = newRow[INDICATOR_CONFIG[keys[1]].dataKey];
        if (val1 && val2) newRow.spread = Math.abs(val1 - val2);
      }
      return newRow;
    });
  }, [data, selectedKeys, chartMode]);

  const rSquared = useMemo(() => {
    if (selectedKeys.size !== 2) return null;
    const keys = Array.from(selectedKeys);
    const key1 = INDICATOR_CONFIG[keys[0]].dataKey;
    const key2 = INDICATOR_CONFIG[keys[1]].dataKey;
    const r2 = calculatePearsonRSquared(data, key1, key2);
    return r2 !== null ? r2.toFixed(2) : null;
  }, [data, selectedKeys]);


  const tooltipStyle = {
    backgroundColor: darkMode ? '#1f2937' : '#ffffff',
    borderColor: darkMode ? '#374151' : '#e5e7eb',
    color: darkMode ? '#f3f4f6' : '#111827',
    borderRadius: '8px'
  };

  const rawTooltipFormatter = (value, name, props) => {
    if (props.dataKey === 'spread') return [value, name];
    const indicatorKey = Object.keys(INDICATOR_CONFIG).find(key => INDICATOR_CONFIG[key].dataKey === props.dataKey);
    if (indicatorKey) return [dataFormatter(value, props.dataKey), name];
    return [value, name];
  };

  const indexedTooltipFormatter = (value, name, props) => {
    if (props.dataKey === 'spread') return [`Difference: ${Math.round(value)}`, name];
    return [`${Math.round(value)}`, name];
  };

  const absoluteYAxisFormatter = (value, dataKey) => {
    const config = Object.values(INDICATOR_CONFIG).find(conf => conf.dataKey === dataKey);
    if (!config) return value; 
    if (config.format === 'percent') return value.toFixed(0) + '%';
    if (config.format === 'count') {
        if (value >= 1000) return (value / 1000).toFixed(0) + 'k';
        return value.toFixed(0);
    }
    return value.toFixed(1);
  };

  const renderDashboard = () => (
    <div className="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 h-[500px] flex flex-col relative"> 
      {rSquared && (
        <div className="group absolute top-4 right-4 z-20 flex items-center gap-2 cursor-help bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm p-2 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
          <span className="text-sm font-bold text-slate-700 dark:text-slate-200">
            R<sup>2</sup> = {rSquared}
          </span>
          <HelpCircle className="w-4 h-4 text-slate-400 hover:text-blue-500 transition-colors" />
          <div className="absolute right-0 top-full mt-2 w-64 p-4 bg-slate-900 text-white text-xs rounded-xl shadow-xl opacity-0 group-hover:opacity-100 transition-all duration-200 pointer-events-none transform translate-y-1 group-hover:translate-y-0">
            <div className="font-bold text-sm mb-2 text-blue-400">Coefficient of Determination</div>
            <p className="mb-3 text-slate-300 leading-relaxed">Measures the strength of the relationship between the two selected indicators.</p>
            <div className="space-y-2">
              <div>
                <span className="text-blue-300 font-semibold block mb-0.5">Why it's interesting:</span>
                <span className="text-slate-400">It reveals if one economic metric effectively predicts or mirrors another.</span>
              </div>
              <div>
                <span className="text-emerald-300 font-semibold block mb-0.5">Why care?</span>
                <span className="text-slate-400">High correlations (near 1.0) suggest a reliable trend; sudden divergences can signal market shifts.</span>
              </div>
            </div>
          </div>
        </div>
      )}

      <div className="mb-2">
        <h3 className="text-lg font-semibold text-gray-800 dark:text-gray-100">
          {chartMode === "indexed" ? "Relative Performance (Indexed to 100)" : "Historical Data (Raw Values)"}
        </h3>
        {chartMode === "indexed" && (
            <p className="text-sm text-gray-500 dark:text-gray-400 mt-1">
                All series start at 100, allowing you to compare percentage growth since the start date.
            </p>
        )}
      </div>
      <div className="flex-1 w-full min-h-0">
        <ResponsiveContainer width="100%" height="100%">
          <ComposedChart data={processedData} margin={{ top: 10, right: 10, left: 0, bottom: 0 }}>
            <CartesianGrid strokeDasharray="3 3" vertical={false} stroke={darkMode ? COLORS.gridDark : COLORS.gridLight} />
            <XAxis dataKey="observation_date" tick={{fill: '#9ca3af', fontSize: 12}} tickLine={false} axisLine={{stroke: '#e5e7eb'}} minTickGap={60} />
            {chartMode === "indexed" ? (
              <YAxis tickFormatter={(value) => Math.round(value)} tick={{fill: '#9ca3af', fontSize: 12}} tickLine={false} axisLine={false} domain={['auto', 'auto']} />
            ) : (
              <>
                <YAxis yAxisId="left" orientation="left" tickFormatter={(value) => absoluteYAxisFormatter(value, INDICATOR_CONFIG[Array.from(selectedKeys)[0]]?.dataKey)} tick={{fill: '#9ca3af', fontSize: 12}} tickLine={false} axisLine={false} />
                {Array.from(selectedKeys).length > 1 && (
                  <YAxis yAxisId="right" orientation="right" tickFormatter={(value) => absoluteYAxisFormatter(value, INDICATOR_CONFIG[Array.from(selectedKeys)[1]]?.dataKey)} tick={{fill: '#9ca3af', fontSize: 12}} tickLine={false} axisLine={false} />
                )}
              </>
            )}
            <Tooltip contentStyle={tooltipStyle} formatter={chartMode === "indexed" ? indexedTooltipFormatter : rawTooltipFormatter} />
            <Legend wrapperStyle={{paddingTop: '20px'}} />
            {REFERENCE_ZONES.map((zone, idx) => (
              <ReferenceArea key={idx} x1={zone.start} x2={zone.end} fill="#9ca3af" fillOpacity={0.3} label={chartMode === "indexed" ? { value: zone.label, position: zone.labelPos || 'insideTop', fontSize: 10, fill: '#a1a1aa' } : undefined} />
            ))}
            {Array.from(selectedKeys).map((key, index) => {
              const config = INDICATOR_CONFIG[key];
              const yAxisId = (chartMode === "absolute" && index > 0 && Array.from(selectedKeys).length > 1) ? "right" : "left";
              return (
                <Line key={key} yAxisId={chartMode === "indexed" ? undefined : yAxisId} type="monotone" dataKey={config.dataKey} name={config.label} stroke={config.color} strokeWidth={2.5} dot={false} connectNulls={true} isAnimationActive={true} animationDuration={500} />
              );
            })}
            {chartMode === "indexed" && selectedKeys.size === 2 && showSpread && (
              <Line type="monotone" dataKey="spread" name="Spread" stroke={COLORS.blue} strokeWidth={2} strokeDasharray="5 5" dot={false} opacity={0.6} />
            )}
          </ComposedChart>
        </ResponsiveContainer>
      </div>
    </div>
  );

  const renderSimpleChart = (title, data, dataKey, color, description, showLastLabel = true, RefLine = null) => (
    <div className="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 h-[500px] flex flex-col">
      <div className="mb-4">
        <h3 className="text-lg font-bold text-gray-800 dark:text-gray-100">{title}</h3>
        <p className="text-sm text-gray-500 dark:text-gray-400">{description}</p>
      </div>
      <div className="flex-1 w-full min-h-0">
        <ResponsiveContainer width="100%" height="100%">
          <ComposedChart data={data} margin={{ top: 10, right: 30, left: 10, bottom: 10 }}>
            <CartesianGrid strokeDasharray="3 3" stroke={darkMode ? COLORS.gridDark : COLORS.gridLight} />
            <XAxis dataKey="date" tickFormatter={(str) => str ? str.substring(0, 4) : ''} stroke="#9ca3af" />
            <YAxis stroke="#9ca3af" tickFormatter={(value) => value.toFixed(0) + '%'} />
            <Tooltip contentStyle={tooltipStyle} formatter={(value) => value.toFixed(2) + '%'} />
            {RefLine}
            <Line 
                type="monotone" 
                dataKey={dataKey} 
                stroke={color} 
                strokeWidth={3} 
                dot={false} 
                label={showLastLabel ? <CustomLabel dataLength={data.length} /> : undefined} 
            />
            <ReferenceArea y1={100} y2={200} fill={COLORS.red} fillOpacity={0.1} label={{value: "Overvalued (>100%)", position: 'insideTopLeft', fontSize: 10, fill: COLORS.red}} />
            <ReferenceArea y1={0} y2={100} fill={COLORS.green} fillOpacity={0.1} label={{value: "Fair Value (<100%)", position: 'insideBottomLeft', fontSize: 10, fill: COLORS.green}} />
          </ComposedChart>
        </ResponsiveContainer>
      </div>
    </div>
  );

  return (
    <div className="min-h-screen bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-100 font-sans transition-colors duration-200">
      <div className="max-w-7xl mx-auto p-4 md:p-6 space-y-6">
        
        <div className="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col md:flex-row justify-between items-center gap-4">
          <div>
            <h1 className="text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2">
              <Activity className="h-6 w-6 text-blue-600 dark:text-blue-400" />
              Economic Indicators
            </h1>
            <p className="text-gray-500 dark:text-gray-400 text-sm mt-1">Live Dashboard & Recession Signals</p>
          </div>
          
          <div className="flex items-center gap-3">
            <button onClick={() => setDarkMode(!darkMode)} className="p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors" title="Toggle Theme">
              {darkMode ? <Sun className="w-5 h-5 text-amber-400" /> : <Moon className="w-5 h-5 text-slate-600" />}
            </button>
            <div className="flex bg-gray-100 dark:bg-gray-700 p-1 rounded-lg">
               {['dashboard', 'sahm', 'philips', 'buffett'].map(mode => (
                 <button key={mode} onClick={() => setViewMode(mode)} className={`px-3 py-1.5 rounded-md text-sm font-medium capitalize transition-all ${viewMode === mode ? 'bg-white dark:bg-gray-600 shadow text-blue-600 dark:text-blue-300' : 'text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200'}`}>
                   {mode}
                 </button>
               ))}
            </div>
          </div>
        </div>

        {viewMode === 'dashboard' && (
          <div className="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <div className="lg:col-span-1 space-y-4">
              <div className="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700">
                 <h3 className="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3">Settings</h3>
                 <div className="flex bg-gray-100 dark:bg-gray-700 p-1 rounded-lg mb-4">
                  <button onClick={() => setChartMode("absolute")} className={`flex-1 py-1.5 rounded text-xs font-medium ${chartMode === "absolute" ? "bg-white dark:bg-gray-600 shadow text-blue-600 dark:text-blue-300" : "text-gray-500 dark:text-gray-400"}`}>Raw</button>
                  <button onClick={() => setChartMode("indexed")} className={`flex-1 py-1.5 rounded text-xs font-medium ${chartMode === "indexed" ? "bg-white dark:bg-gray-600 shadow text-blue-600 dark:text-blue-300" : "text-gray-500 dark:text-gray-400"}`}>Relative</button>
                </div>
                {chartMode === 'indexed' && selectedKeys.size === 2 && (
                  <button onClick={() => setShowSpread(!showSpread)} className="w-full mb-4 flex items-center justify-between px-3 py-2 text-xs font-medium rounded bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300">
                    <span>Show Spread</span>
                    {showSpread ? <CheckSquare className="w-4 h-4"/> : <Square className="w-4 h-4"/>}
                  </button>
                )}
                <h2 className="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3">Metrics</h2>
                <div className="space-y-1">
                  {Object.keys(INDICATOR_CONFIG).map((key) => {
                    const config = INDICATOR_CONFIG[key];
                    const isSelected = selectedKeys.has(key);
                    if (key === 'GDP' || key === 'Stock Market (b)') return null; 
                    return (
                      <button key={key} onClick={() => toggleIndicator(key)} className={`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm transition-all border ${isSelected ? "bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-800 dark:text-blue-200" : "border-transparent hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300"}`}>
                        {isSelected ? <CheckSquare className="w-5 h-5 text-blue-600 dark:text-blue-400" /> : <Square className="w-5 h-5 text-gray-300 dark:text-gray-600" />}
                        <span className="flex-1 text-left truncate">{config.label}</span>
                      </button>
                    );
                  })}
                </div>
              </div>
            </div>
            <div className="lg:col-span-3 space-y-6">
              {renderDashboard()}
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                {Array.from(selectedKeys).map(key => (
                  <div key={key} className="bg-white dark:bg-gray-800 p-5 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 flex items-start gap-3">
                    <div className="mt-1 w-3 h-3 rounded-full flex-shrink-0" style={{ backgroundColor: INDICATOR_CONFIG[key].color }} />
                    <div>
                      <h4 className="font-semibold text-gray-900 dark:text-gray-100">{INDICATOR_CONFIG[key].label}</h4>
                      <p className="text-sm text-gray-600 dark:text-gray-400 mt-1">{INDICATOR_CONFIG[key].definition}</p>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        )}

        {viewMode === 'sahm' && (
          <div className="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 h-[500px] flex flex-col">
            <div className="mb-4">
              <h3 className="text-lg font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2">
                <AlertTriangle className="w-5 h-5 text-red-600" /> Sahm Rule Indicator
              </h3>
              <p className="text-sm text-gray-500 dark:text-gray-400">Signals recession when 3-month moving average of unemployment rises 0.50% above the previous 12-month low.</p>
            </div>
            <div className="flex-1 w-full min-h-0">
              <ResponsiveContainer width="100%" height="100%">
                <AreaChart data={sahmData} margin={{ top: 10, right: 30, left: 10, bottom: 10 }}>
                  <CartesianGrid strokeDasharray="3 3" stroke={darkMode ? COLORS.gridDark : COLORS.gridLight} />
                  <XAxis dataKey="date" tickFormatter={(str) => str.substring(0, 4)} stroke="#9ca3af" />
                  <YAxis stroke="#9ca3af" />
                  <Tooltip contentStyle={tooltipStyle} />
                  <ReferenceArea y1={0.5} label="Threshold (0.50)" stroke="red" strokeDasharray="3 3" />
                  <Area type="monotone" dataKey="sahmValue" stroke="#ef4444" fill="#ef4444" fillOpacity={0.3} />
                </AreaChart>
              </ResponsiveContainer>
            </div>
          </div>
        )}

        {viewMode === 'philips' && (
           <div className="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 h-[500px] flex flex-col">
             <div className="mb-4">
               <h3 className="text-lg font-bold text-gray-800 dark:text-gray-100">The Philips Curve (Unemployment vs. Inflation)</h3>
               <p className="text-sm text-gray-500 dark:text-gray-400">The curve illustrates the historical inverse relationship between the rate of unemployment and the rate of inflation (measured as year-over-year CPI change). A movement to the left and down suggests a strong economy with low inflation, while movements up and to the right suggest stagflation.</p>
             </div>
             <div className="flex-1 w-full min-h-0">
              <ResponsiveContainer width="100%" height="100%">
                <ScatterChart margin={{ top: 20, right: 20, bottom: 10, left: 10 }}>
                  <CartesianGrid strokeDasharray="3 3" stroke={darkMode ? COLORS.gridDark : COLORS.gridLight} />
                  <XAxis type="number" dataKey="x" name="Unemployment" unit="%" stroke="#9ca3af" />
                  <YAxis type="number" dataKey="y" name="Inflation" unit="%" stroke="#9ca3af" />
                  <Tooltip cursor={{ strokeDasharray: '3 3' }} contentStyle={tooltipStyle} />
                  <Scatter name="Philips" data={philipsData} fill={COLORS.purple} />
                </ScatterChart>
              </ResponsiveContainer>
             </div>
           </div>
        )}

        {viewMode === 'buffett' && (
          <div className="space-y-4">
            <div className="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700">
               <h3 className="text-lg font-bold text-gray-800 dark:text-gray-100 mb-2">What is the Buffett Indicator?</h3>
               <p className="text-sm text-gray-600 dark:text-gray-400 leading-relaxed">
                  The Buffett Indicator is the ratio of the total US stock market valuation (measured by the Wilshire 5000 index) to GDP. It assesses if the market is undervalued or overvalued relative to the economy's size.
                  <br/><br/>
                  A ratio significantly <strong>above 100%</strong> suggests the market is <strong>overvalued</strong>.
               </p>
            </div>
           {buffettData.length > 0 ? (
               renderSimpleChart(
                   "Buffett Indicator (Total Market / GDP)", 
                   buffettData, 
                   "ratio", 
                   COLORS.green, 
                   "Historical trend of the Wilshire 5000 Total Market Cap to GDP ratio.",
                   false 
               )
           ) : (
               <div className="p-12 text-center text-gray-400 bg-white dark:bg-gray-800 rounded-xl border border-dashed border-gray-300 dark:border-gray-700">
                   <h3 className="text-lg font-semibold text-gray-600 dark:text-gray-300">Missing Data</h3>
                   <p className="text-sm mt-2">The 'Buffett Indicator' requires the **GDP** and **Stock Market** columns to be present in the data.</p>
               </div>
           )}
          </div>
        )}
      </div>
    </div>
  );
}